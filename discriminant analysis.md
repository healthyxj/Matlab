# 判别分析
* 定义
判别分析是用于判别样品所属类型的一种统计分析方法，根据表明事物特点的变量值和它所属的类，求出判别函数。
根据判别函数对未知所属类别的事物进行分类的一种分析方法。
~~~
通俗地讲，判别分析中，至少有一个已经明确知道类别的训练样本，利用这个数据可以就可以建立判别准则，并通过预测变量来为未知类别的观测值进行判别。
~~~
判别分析的方法主要有距离判别、费希尔(fisher)判别、逐步判别

## 1、距离判别
对于m元总体引入马氏距离的概念。
马氏距离：设总体G为m维总体（考察m个指标），均值向量为μ，协方差阵为Σ=(σij)m×m，则样品X（m维列向量）与总体G的马氏距离为d²(X,G)=(X-μ)^T * Σ^-1 * (X-μ)
~~~
方差(variance)用于度量随机变量和其他数学期望(均值)之间的偏离程度，协方差用于衡量两个变量之间的总体误差。方差是协方差的特殊情况。
Σ^-1表示协方差的倒数。因此对于一维总体，马氏距离为(X-μ)²/σ²
~~~
对于二维随机变量，要知道两者之间的关系，需要用到协方差。
### Matlab中正态分布函数的调用
~~~
%创建一个数组
x = 0:0.1:10;
%利用gaussmf建立正态分布
y = gaussmf(x,[2,5]);
plot(x,y);
xlabel('gaussmf, P = [2 5]')
~~~
### 两总体下的马氏距离
对于两个总体G1和G2，X是一个m维向量。μ1、μ2、Σ1、Σ2分别为总体G1、G2的均值和协方差。同样采用马氏距离，只不过要对G、μ、Σ增加下标。
即d²(X,G1)=(X-μ1)^T * Σ1^-1 * (X-μ1)和d²(X,G2)=(X-μ2)^T * Σ2^-1 * (X-μ2)
若d²(X,G1) < d²(X,G2)，则判定X属于1总体。

Σ1=Σ2时，为应用上的方便，令μ'=(μ1+μ2)/2，Σ1=Σ2=Σ

W(X)=(X-μ')^T * Σ^-1 * (X-μ')

推导可得d²(X,G1) - d²(X,G2) = -2W(X)

若W(X) < 0,X属于G1；W(X)称为判别函数。
~~~
%协方差的使用
A=[61.45,55.9,61.95,59,58.14,53.61,55.48,54.21,61.52,54.92]; 
B=[40.36,39.8,49.2,48,51.5,49.39,51.13,58.06,61,62.35];
C=[8.61,8.91,10.43,13.32,13.48,15.75,18.14,19.95,21.95,23.53];
D=[14.31,14.72,15.28,15.91,14.67,15,15.86,15.16,13.72,12.94];
E=[7.67,7.75,8.15,9.24,10.68,10.58,10.31,10,8.91,8.51];
q=[A',B',C',D',E'];
w=cov(q)
~~~

## 2、fisher判别分析
用投影的方法将k个不同总体在m维空间上的点尽可能分散，同一总体内的样本要尽可能集中。"find a linear combination of variables x that would produce "maximally different" discriminant scores across group"
* 基本思想:
投影（降维）
* 目标:
最小化类内方差，最大化类间方差
~~~
找到一个(一组)投影轴使样本投影到该空间后能在保证方差最小的情况下，将不同类的样本分开。并将度量类别均值之间差别的量称为类间方差(类间散布矩阵);度量这些均值周围方差的量称为类内方差(类内散布矩阵)
~~~
* 数学表示

设A、B两个总体，分别有n1和n2个历史样本数据，每个样本有m个观测指标，则每个样本可以看作m维空间中的一点。Fisher借助方差分析的思想构造了一个线性判别函数：Y = C1X1+C2X2+ + CmXm = C‘X

其中，判别系数Ci应使得AB类样本点群尽可能远离，同一类样本点尽可能集中。

记ya'表示ya的均值，yb'表示yb的均值。则fisher判别分析的数学表示是max(ya'-yb')²,同时min(yai-ya')²(i=1,2,……,na)和min(ybi-yb')²。因此可以构造一个统计量I(c1,c2,……,cm)=(ya'-yb')²/(Σ(yai-ya')²+Σ(ybi-yb')²)

只要I取最大值就可以满足fisher准则的要求。
~~~
哪个总体、哪个样本、样本的哪个参数是应用过程中需要注意的。
y是判别分析函数，yai是总体A的第i个样本
~~~
### 计算步骤
* 输入历史数据，计算总体A、B的均值X(A)'和X(B)'
* 计算dj和sj（j=1,2,……m）
* 解方程组sc = d(s是样本)，求出c = s^-1 * d，建立判别函数y(X)=c1x1+c2x2+……+cmxm
* 对新样本作判别
  * 将新样本m个观测值带入判别函数，求出y值
  * 确定临界值y(A)'和y(B)'
  将两类总体样本的判别函数之均值，求加权平均值y0=(n1y(A)'+n2y(B)')/(n1+n2)作为临界值
* 做出判别:
若y(A)'>y(B)',则y>y0时，新样本属于A类;y<y0时，新样本属于B类

若y(A)'<y(B)',则y>y0时，新样本属于B类;y<y0时，新样本属于A类

